<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Text Generator</title>
    <style>
        :root {
            --bt-primary: #6200EE;
            --bt-primary-hover: #5300d6;
            --ee-primary: #009999;
            --ee-primary-hover: #007a7a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f9;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        .container {
            width: 100%;
            max-width: 700px;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: box-shadow 0.3s ease;
        }
        .container:hover {
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        .logo-container {
            text-align: center;
            margin-bottom: 20px;
            height: 50px;
        }
        .logo-container svg {
            height: 100%;
            width: auto;
        }
        h1 {
            color: #1a2533;
            text-align: center;
            margin-top: 0;
            margin-bottom: 25px;
        }
        label {
            display: block;
            font-weight: 600;
            color: #3b4d61;
            margin-bottom: 8px;
        }
        select, textarea, input[type="text"] {
            width: 100%;
            padding: 12px;
            border: 1px solid #dbe2e8;
            border-radius: 6px;
            font-size: 16px;
            box-sizing: border-box;
        }
        textarea { margin-top: 10px; height: 200px; resize: vertical; background-color: #f8f9fa; }
        button {
            display: block;
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .status { text-align: center; margin-top: 15px; color: #28a745; font-weight: 500; height: 20px; }

        .selection-group { margin-bottom: 20px; }
        .selection-group .group-title {
            display: block;
            font-weight: 600;
            color: #3b4d61;
            margin-bottom: 8px;
        }

        .pill-toggle {
            display: flex;
            gap: 0;
            border: 1px solid #dbe2e8;
            border-radius: 6px;
            overflow: hidden;
        }
        .pill-toggle label {
            flex: 1;
            text-align: center;
            padding: 12px;
            margin: 0;
            cursor: pointer;
            background-color: #f8f9fa;
            color: #555;
            transition: background-color 0.2s, color 0.2s;
        }
        .pill-toggle input[type="radio"] { display: none; }
        .pill-toggle input[type="radio"]:checked + label {
            background-color: #1a2533;
            color: #ffffff;
        }

        .brand-selector { justify-content: center; }
        #charCounter {
            text-align: right;
            color: #555;
            font-size: 14px;
            margin-top: 5px;
            height: auto;
        }
        .feedback-text {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #6c757d;
        }
        .feedback-text a {
            text-decoration: none;
        }
        .feedback-text a:hover {
            text-decoration: underline;
        }

        /* --- Custom Search/Select Input --- */
        select:disabled {
            background-color: #eef1f4;
            color: #7b8794;
            cursor: not-allowed;
        }
        
        /* --- Theme Styling --- */
        .theme-bt button { background-color: var(--bt-primary); }
        .theme-bt button:hover { background-color: var(--bt-primary-hover); }
        .theme-bt .brand-selector input[type="radio"]:checked + label { background-color: var(--bt-primary); color: white; }
        .theme-bt .pill-toggle input[type="radio"]:checked + label { background-color: var(--bt-primary); }
        .theme-bt #logo-ee { display: none; }
        .theme-bt #logo-bt { display: block; }
        .theme-bt .feedback-text a { color: var(--bt-primary); }

        .theme-ee button { background-color: var(--ee-primary); }
        .theme-ee button:hover { background-color: var(--ee-primary-hover); }
        .theme-ee .brand-selector input[type="radio"]:checked + label { background-color: var(--ee-primary); color: white; }
        .theme-ee .pill-toggle input[type="radio"]:checked + label { background-color: var(--ee-primary); }
        .theme-ee #logo-bt { display: none; }
        .theme-ee #logo-ee { display: block; }
        .theme-ee .feedback-text a { color: var(--ee-primary); }
    </style>
</head>
<body>

    <div class="container theme-bt">
        <div class="logo-container">
            <!-- BT Logo SVG -->
            <svg id="logo-bt" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" fill="var(--bt-primary)">
                <circle cx="50" cy="50" r="48" stroke="currentColor" stroke-width="4" fill="none"/>
                <text x="50" y="68" font-family="Arial, Helvetica, sans-serif" font-size="50" font-weight="bold" text-anchor="middle" fill="currentColor">BT</text>
            </svg>
            <!-- EE Logo SVG -->
            <svg id="logo-ee" viewBox="0 0 80 40" xmlns="http://www.w3.org/2000/svg" fill="var(--ee-primary)">
                <text x="0" y="32" font-family="Arial, Helvetica, sans-serif" font-size="40" font-weight="bold" fill="currentColor">EE</text>
            </svg>
        </div>
        <h1>Contact Text Generator</h1>

        <div class="selection-group">
            <span class="group-title">Select your brand</span>
            <div class="pill-toggle brand-selector">
                <input type="radio" id="brandBT" name="brand" value="BT" checked>
                <label for="brandBT">BT</label>
                <input type="radio" id="brandEE" name="brand" value="EE">
                <label for="brandEE">EE</label>
            </div>
        </div>

        <div class="selection-group">
            <span class="group-title">Message type</span>
            <div class="pill-toggle">
                <input type="radio" id="typePre" name="messageType" value="pre" checked>
                <label for="typePre">Pre-text</label>
                <input type="radio" id="typePost" name="messageType" value="post">
                <label for="typePost">Post-text</label>
            </div>
        </div>

        <div class="selection-group">
            <span class="group-title">Was contact made?</span>
            <div class="pill-toggle">
                <input type="radio" id="contactNo" name="contactStatus" value="no" checked>
                <label for="contactNo">No</label>
                <input type="radio" id="contactYes" name="contactStatus" value="yes">
                <label for="contactYes">Yes</label>
            </div>
        </div>

        <div class="selection-group">
            <label class="group-title" for="scenarioSelect">Select a reason</label>
            <select id="scenarioSelect"></select>
        </div>
        
        <textarea id="messageOutput" placeholder="Your generated message will appear here..."></textarea>
        <div id="charCounter"></div>
        
        <button id="copyButton">Copy Message</button>
        <div id="statusMessage" class="status"></div>
        <p class="feedback-text">Any feedback is welcome, please email me: <a href="mailto:calumbarnes@ee.co.uk">calumbarnes@ee.co.uk</a></p>
    </div>

<script>
    // --- Get references to all the interactive elements on the page ---
    const container = document.querySelector('.container');
    const messageOutput = document.getElementById('messageOutput');
    const copyButton = document.getElementById('copyButton');
    const statusMessage = document.getElementById('statusMessage');
    const brandRadios = document.querySelectorAll('input[name="brand"]');
    const messageTypeRadios = document.querySelectorAll('input[name="messageType"]');
    const contactRadios = document.querySelectorAll('input[name="contactStatus"]');
    const scenarioSelect = document.getElementById('scenarioSelect');
    const charCounter = document.getElementById('charCounter');

    let selectedScenarioId = null;

    // --- Scenario definitions grouped by message type and contact status ---
    const scenarios = [
        {
            id: 'pre_no_general_call',
            dropdownText: 'General Account Call',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `regarding your account. I'll try calling you in the next few minutes from an 0800 number.`,
                EE: `regarding your account. I'll try calling you in the next few minutes from an 0800 number.`
            }
        },
        {
            id: 'pre_no_order_issue',
            dropdownText: 'Issue With Order',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `we need to discuss an issue with your recent order. I'll be calling you shortly from an 0800 number to go over the details.`,
                EE: `we need to discuss an issue with your recent order. I'll be calling you shortly from an 0800 number to go over the details.`
            }
        },
        {
            id: 'pre_no_order_update',
            dropdownText: 'Order Progress Update',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `I'm calling to provide a progress update on your order. I'll try your number in the next few minutes from an 0800 number.`,
                EE: `I'm calling to provide a progress update on your order. I'll try your number in the next few minutes from an 0800 number.`
            }
        },
        {
            id: 'pre_no_engineer_booking',
            dropdownText: 'Book Engineer Visit',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `I'm calling to book in your engineer appointment to get your new service installed. I'll call you in the next few minutes from an 0800 number.`,
                EE: `I'm calling to book in your engineer appointment to get your new service installed. I'll call you in the next few minutes from an 0800 number.`
            }
        },
        {
            id: 'pre_no_engineer_reminder',
            dropdownText: 'Engineer Appointment Reminder',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `I'm calling with a quick reminder about your scheduled engineer visit. I'll be calling shortly from an 0800 number to confirm the details and answer any questions.`,
                EE: `I'm calling with a quick reminder about your scheduled engineer visit. I'll be calling shortly from an 0800 number to confirm the details and answer any questions.`
            }
        },
        {
            id: 'pre_no_query_follow_up',
            dropdownText: 'Follow Up On A Query',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `I'm following up on your recent query. I will be calling you shortly from an 0800 number to discuss this further.`,
                EE: `I'm following up on your recent query. I will be calling you shortly from an 0800 number to discuss this further.`
            }
        },
        {
            id: 'pre_no_complaint_follow_up',
            dropdownText: 'Follow Up On A Complaint',
            type: 'pre',
            contact: 'no',
            templates: {
                BT: `regarding your recent complaint. I will be calling you in the next few minutes from an 0800 number to discuss how we can resolve this for you.`,
                EE: `regarding your recent complaint. I will be calling you in the next few minutes from an 0800 number to discuss how we can resolve this for you.`
            }
        },
        {
            id: 'pre_yes_follow_up_call',
            dropdownText: 'Agreed Follow-Up Call',
            type: 'pre',
            contact: 'yes',
            templates: {
                BT: `thanks for speaking with me earlier today. As agreed, I'll give you another call shortly from an 0800 number to pick up where we left off.`,
                EE: `thanks for speaking with me earlier today. As agreed, I'll give you another call shortly from an 0800 number to pick up where we left off.`
            }
        },
        {
            id: 'post_no_callback_request',
            dropdownText: 'Call Back Request',
            type: 'post',
            contact: 'no',
            templates: {
                BT: `I tried to reach you today regarding your account. When you can, please call us back on 0800 800 150 so we can help.`,
                EE: `I tried to reach you today regarding your account. When you can, please call us back on 150 from your EE phone or 0800 079 8586 so we can help.`
            }
        },
        {
            id: 'post_no_open_complaint',
            dropdownText: 'Call About Open Complaint On Account',
            type: 'post',
            contact: 'no',
            templates: {
                BT: `I tried calling about the open complaint on your account. Please call us back on 0800 800 150 so we can talk through the details and next steps with you.`,
                EE: `I tried calling about the open complaint on your account. Please call us back on 150 from your EE phone or 0800 079 8586 so we can talk through the details and next steps with you.`
            }
        },
        {
            id: 'post_no_engineer_update',
            dropdownText: 'Engineer Appointment Update Needed',
            type: 'post',
            contact: 'no',
            templates: {
                BT: `I tried to reach you with an update about your engineer appointment. Please give us a call on 0800 800 150 so we can confirm the details.`,
                EE: `I tried to reach you with an update about your engineer appointment. Please give us a call on 150 from your EE phone or 0800 079 8586 so we can confirm the details.`
            }
        },
        {
            id: 'post_yes_thank_you',
            dropdownText: 'Thanks After Successful Call',
            type: 'post',
            contact: 'yes',
            templates: {
                BT: `thanks for speaking with me today. As discussed, if you need any more help please give us a call on 0800 800 150 and we’ll be happy to support.`,
                EE: `thanks for speaking with me today. As discussed, if you need any more help please give us a call on 150 from your EE phone or 0800 079 8586 and we’ll be happy to support.`
            }
        },
        {
            id: 'post_yes_follow_up_actions',
            dropdownText: 'Follow Up With Agreed Actions',
            type: 'post',
            contact: 'yes',
            templates: {
                BT: `thanks for your time today. We’ve agreed the next steps and I’ll keep an eye on things, but if anything changes please call us on 0800 800 150.`,
                EE: `thanks for your time today. We’ve agreed the next steps and I’ll keep an eye on things, but if anything changes please call us on 150 from your EE phone or 0800 079 8586.`
            }
        }
    ];

    function getSelectedBrand() {
        return document.querySelector('input[name="brand"]:checked').value;
    }

    function getSelectedMessageType() {
        return document.querySelector('input[name="messageType"]:checked').value;
    }

    function getSelectedContactStatus() {
        return document.querySelector('input[name="contactStatus"]:checked').value;
    }

    function populateScenarioOptions() {
        const selectedType = getSelectedMessageType();
        const selectedContact = getSelectedContactStatus();

        const filteredScenarios = scenarios
            .filter(scenario => scenario.type === selectedType && scenario.contact === selectedContact)
            .sort((a, b) => a.dropdownText.localeCompare(b.dropdownText));

        scenarioSelect.innerHTML = '';

        if (filteredScenarios.length === 0) {
            const option = document.createElement('option');
            option.value = '';
            option.textContent = 'No scenarios available for this selection';
            scenarioSelect.appendChild(option);
            scenarioSelect.disabled = true;
            selectedScenarioId = null;
            messageOutput.value = '';
            updateCharCounter();
            return;
        }

        scenarioSelect.disabled = false;

        const preservedScenario = filteredScenarios.find(scenario => scenario.id === selectedScenarioId);
        const scenarioToSelect = preservedScenario || filteredScenarios[0];
        selectedScenarioId = scenarioToSelect.id;

        filteredScenarios.forEach(scenario => {
            const option = document.createElement('option');
            option.value = scenario.id;
            option.textContent = scenario.dropdownText;
            option.selected = scenario.id === selectedScenarioId;
            scenarioSelect.appendChild(option);
        });

        scenarioSelect.value = selectedScenarioId;
        generateMessage();
    }

    // --- Function to update the theme (colors and logos) ---
    function updateTheme() {
        const selectedBrand = getSelectedBrand();
        if (selectedBrand === 'BT') {
            container.classList.add('theme-bt');
            container.classList.remove('theme-ee');
        } else {
            container.classList.add('theme-ee');
            container.classList.remove('theme-bt');
        }
    }

    // --- Main function to generate the final message ---
    function generateMessage() {
        if (!selectedScenarioId) {
            messageOutput.value = '';
            updateCharCounter();
            return;
        }

        const selectedScenario = scenarios.find(scenario => scenario.id === selectedScenarioId);
        if (!selectedScenario) {
            messageOutput.value = '';
            updateCharCounter();
            return;
        }

        const selectedBrand = getSelectedBrand();
        const message = selectedScenario.templates[selectedBrand] || '';
        messageOutput.value = message;

        updateCharCounter();
    }

    // --- Function to update the character and SMS counter ---
    function updateCharCounter() {
        const charLength = messageOutput.value.length;
        const smsCount = Math.ceil(charLength / 160);
        if (charLength > 0) {
            charCounter.textContent = `${charLength} characters (${smsCount} SMS)`;
        } else {
            charCounter.textContent = '';
        }
    }

    // --- Event Listeners ---
    function initializeInterface() {
        updateTheme();
        populateScenarioOptions();
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeInterface);
    } else {
        initializeInterface();
    }

    brandRadios.forEach(radio => radio.addEventListener('change', () => {
        updateTheme();
        generateMessage();
    }));

    messageTypeRadios.forEach(radio => radio.addEventListener('change', () => {
        selectedScenarioId = null;
        populateScenarioOptions();
    }));

    contactRadios.forEach(radio => radio.addEventListener('change', () => {
        selectedScenarioId = null;
        populateScenarioOptions();
    }));

    scenarioSelect.addEventListener('change', () => {
        selectedScenarioId = scenarioSelect.value || null;
        generateMessage();
    });

    copyButton.addEventListener('click', () => {
        if (messageOutput.value) {
            try {
                messageOutput.select();
                messageOutput.setSelectionRange(0, 99999);
                const successful = document.execCommand('copy');

                if (successful) {
                    statusMessage.textContent = 'Message copied to clipboard!';
                } else {
                    statusMessage.textContent = 'Failed to copy!';
                }
                window.getSelection().removeAllRanges();

            } catch (err) {
                statusMessage.textContent = 'Failed to copy!';
                console.error('Error copying text: ', err);
            } finally {
                setTimeout(() => { statusMessage.textContent = ''; }, 2000);
            }
        }
    });

    messageOutput.addEventListener('input', updateCharCounter);

</script>

</body>
</html>
